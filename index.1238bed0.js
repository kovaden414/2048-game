const e=new class{constructor(e){this.initialState=e||Array.from({length:4},()=>[,,,,].fill(0)),this.board=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.score=0}start(){this.status="playing",this.addRandomTile(),this.addRandomTile()}moveDown(){this.move("down")}moveUp(){this.move("up")}moveRight(){this.move("right")}moveLeft(){this.move("left")}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}restart(){this.board=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.score=0}move(e){let t=JSON.stringify(this.board);if("playing"===this.status){if("up"===e||"down"===e)for(let t=0;t<4;t++){let s="up"===e?this.board.map(e=>e[t]):this.board.map(e=>e[t]).reverse();s="up"===e?this.combineTiles(s):this.combineTiles(s).reverse();for(let e=0;e<4;e++)this.board[e][t]=s[e]}else if("left"===e||"right"===e)for(let t=0;t<4;t++)"left"===e?this.board[t]=this.combineTiles(this.board[t]):this.board[t]=this.combineTiles(this.board[t].reverse()).reverse();t!==JSON.stringify(this.board)&&this.addRandomTile(),this.endGame()}}combineTiles(e){let t=e.filter(e=>0!==e);for(let e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,this.score+=t[e],t[e+1]=0);return(t=t.filter(e=>0!==e)).concat(Array(4-t.length).fill(0))}getEmptyCells(){let e=[];for(let t=0;t<4;t++)for(let s=0;s<4;s++)0===this.board[t][s]&&e.push({row:t,col:s});return e}addRandomTile(){let e=this.getEmptyCells();if(0===e.length)return;let{row:t,col:s}=e[Math.floor(Math.random()*e.length)];this.board[t][s]=.9>Math.random()?2:4}endGame(){let e=!0;for(let t=0;t<4;t++)for(let s=0;s<4;s++)this.board[t][s]>=2048&&(this.status="win"),(t<3&&this.board[t][s]===this.board[t+1][s]||s<3&&this.board[t][s]===this.board[t][s+1])&&(e=!1);0===this.getEmptyCells().length&&e&&(this.status="lose")}};document.addEventListener("DOMContentLoaded",()=>{function t(){switch(e.status){case"idle":document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden");break;case"playing":document.querySelector(".message-start").classList.add("hidden");break;case"win":document.querySelector(".message-win").classList.remove("hidden");break;case"lose":document.querySelector(".message-lose").classList.remove("hidden")}!function(){let t=document.querySelector(".button");"idle"===e.status?(t.classList.remove("restart"),t.classList.add("start"),t.textContent="Start"):(t.classList.remove("start"),t.classList.add("restart"),t.textContent="Restart")}()}function s(){document.querySelector(".game-score").textContent=e.score}function r(){let t=document.querySelectorAll(".field-cell"),s=0;for(let r=0;r<4;r++)for(let i=0;i<4;i++){let o=t[s];o.textContent=e.board[r][i]||"",o.className=`field-cell field-cell--${e.board[r][i]}`,s++}}document.querySelector(".button").addEventListener("click",()=>{"idle"===e.status?e.start():e.restart(),t(),s(),r()}),document.addEventListener("keydown",i=>{switch(i.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}t(),s(),r()})});
//# sourceMappingURL=index.1238bed0.js.map
