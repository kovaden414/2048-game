var e;e=new/*#__PURE__*/(function(){var e;function t(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.initialState=e||Array.from({length:4},function(){return[,,,,].fill(0)}),this.board=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.score=0}return e=[{key:"start",value:function(){this.status="playing",this.addRandomTile(),this.addRandomTile()}},{key:"moveDown",value:function(){this.move("down")}},{key:"moveUp",value:function(){this.move("up")}},{key:"moveRight",value:function(){this.move("right")}},{key:"moveLeft",value:function(){this.move("left")}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"restart",value:function(){this.board=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.score=0}},{key:"move",value:function(e){var t=this,r=function(r){var s="up"===e?t.board.map(function(e){return e[r]}):t.board.map(function(e){return e[r]}).reverse();s="up"===e?t.combineTiles(s):t.combineTiles(s).reverse();for(var a=0;a<4;a++)t.board[a][r]=s[a]},s=JSON.stringify(this.board);if("playing"===this.status){if("up"===e||"down"===e)for(var a=0;a<4;a++)r(a);else if("left"===e||"right"===e)for(var i=0;i<4;i++)"left"===e?this.board[i]=this.combineTiles(this.board[i]):this.board[i]=this.combineTiles(this.board[i].reverse()).reverse();s!==JSON.stringify(this.board)&&this.addRandomTile(),this.endGame()}}},{key:"combineTiles",value:function(e){for(var t=e.filter(function(e){return 0!==e}),r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,this.score+=t[r],t[r+1]=0);return(t=t.filter(function(e){return 0!==e})).concat(Array(4-t.length).fill(0))}},{key:"getEmptyCells",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push({row:t,col:r});return e}},{key:"addRandomTile",value:function(){var e=this.getEmptyCells();if(0!==e.length){var t=e[Math.floor(Math.random()*e.length)],r=t.row,s=t.col;this.board[r][s]=.9>Math.random()?2:4}}},{key:"endGame",value:function(){for(var e=!0,t=0;t<4;t++)for(var r=0;r<4;r++)this.board[t][r]>=2048&&(this.status="win"),(t<3&&this.board[t][r]===this.board[t+1][r]||r<3&&this.board[t][r]===this.board[t][r+1])&&(e=!1);0===this.getEmptyCells().length&&e&&(this.status="lose")}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(t.prototype,e),t}()),document.addEventListener("DOMContentLoaded",function(){var t=function(){var t=document.querySelector(".button");"idle"===e.status?(t.classList.remove("restart"),t.classList.add("start"),t.textContent="Start"):(t.classList.remove("start"),t.classList.add("restart"),t.textContent="Restart")},r=function(){switch(e.status){case"idle":document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden");break;case"playing":document.querySelector(".message-start").classList.add("hidden");break;case"win":document.querySelector(".message-win").classList.remove("hidden");break;case"lose":document.querySelector(".message-lose").classList.remove("hidden")}t()},s=function(){document.querySelector(".game-score").textContent=e.score},a=function(){for(var t=document.querySelectorAll(".field-cell"),r=0,s=0;s<4;s++)for(var a=0;a<4;a++){var i=t[r];i.textContent=e.board[s][a]||"",i.className="field-cell field-cell--".concat(e.board[s][a]),r++}};document.querySelector(".button").addEventListener("click",function(){"idle"===e.status?e.start():e.restart(),r(),s(),a()}),document.addEventListener("keydown",function(t){switch(t.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}r(),s(),a()})});
//# sourceMappingURL=index.ae8ac2bc.js.map
